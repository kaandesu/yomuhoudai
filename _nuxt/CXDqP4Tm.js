import{a8 as u,q as f}from"./Dwxyfy7Q.js";import{c as i}from"./CbtZgB9K.js";var k={};const g=k.DEV_MODE==="true",h=g?"http://127.0.0.1:1234":"https://laravel.yomuhoudai.club",T=u("Library",()=>{const c=f([]),m=f([]),l=f(!1);return{loading:l,books:c,getBooks:()=>$fetch.create({baseURL:h,onResponse({response:o}){var s;c.value=o._data.data??[],c.value.length>0&&i({message:"Books loaded successfully",toastOps:{description:((s=o._data.data)==null?void 0:s.message)??""},type:"success"})()},onResponseError({response:o}){var s;i({message:"Failed to load books",toastOps:{description:((s=o._data)==null?void 0:s.message)??"Unknown error"},type:"error"})()}})("/api/v1/books",{method:"GET"}),getBookById:({id:d,onSuccess:o,onError:s})=>{const p=$fetch.create({baseURL:h,onResponse({response:a}){var t,e;i({message:"Book loaded successfully",toastOps:{description:((t=a._data)==null?void 0:t.message)??""},type:"success"})(),o==null||o((e=a._data)==null?void 0:e.data)},onResponseError({response:a}){var t,e;i({message:`Failed to load book with id ${d}`,toastOps:{description:((t=a._data)==null?void 0:t.message)??"Unknown error"},type:"error"})(),s==null||s(((e=a._data)==null?void 0:e.message)??`Error loading book with id ${d}`)}});return l.value=!0,p(`/api/v1/books/${d}`,{method:"GET"}).finally(()=>{l.value=!1})},createBook:async({book:d,onSuccess:o,onError:s})=>{const p=$fetch.create({baseURL:h,onResponse({response:a}){var e,n;if(!a.ok)return;i({message:"Book created successfully",toastOps:{description:((e=a._data)==null?void 0:e.message)??""},type:"success"})();const t=(n=a._data)==null?void 0:n.data;t&&(c.value.push(t),o==null||o(t))},onResponseError({response:a}){var t,e;i({message:"Failed to create book",toastOps:{description:((t=a._data)==null?void 0:t.message)??"Unknown error"},type:"error"})(),s==null||s(((e=a._data)==null?void 0:e.message)??"Failed to create book")}});return l.value=!0,p("/api/v1/books",{method:"POST",headers:{"Content-Type":"application/json"},body:d}).finally(()=>{l.value=!1})},updateBook:async({book:d,onSuccess:o,onError:s})=>{const p=$fetch.create({baseURL:h,onResponse({response:e}){var n,r;i({message:"Book updated successfully",toastOps:{description:((n=e._data)==null?void 0:n.message)??""},type:"success"})(),o==null||o((r=e._data)==null?void 0:r.data)},onResponseError({response:e}){var n,r;i({message:`Failed to update book with id ${d.id}`,toastOps:{description:((n=e._data)==null?void 0:n.message)??"Unknown error"},type:"error"})(),s==null||s(((r=e._data)==null?void 0:r.message)??`Failed to update book with id ${d.id}`)}});l.value=!0;const{id:a,...t}=d;return p(`/api/v1/books/${d.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:t}).finally(()=>{l.value=!1})},deleteBook:async({id:d,onSuccess:o,onError:s})=>{const p=$fetch.create({baseURL:h,onResponse({response:a}){var e;i({message:"Book deleted successfully",toastOps:{description:((e=a._data)==null?void 0:e.message)??""},type:"success"})();const t=c.value.findIndex(n=>n.id===d);t!==-1&&c.value.splice(t,1),o==null||o(a._data)},onResponseError({response:a}){var e,n,r;const t=((e=c.value.find(y=>y.id===d))==null?void 0:e.title)??`book with id ${d}`;i({message:`Failed to delete ${t}`,toastOps:{description:((n=a._data)==null?void 0:n.message)??"Unknown error"},type:"error"})(),s==null||s(((r=a._data)==null?void 0:r.message)??`Failed to delete book with id ${d}`)}});return l.value=!0,p(`/api/v1/books/${d}`,{method:"DELETE"}).finally(()=>{l.value=!1})},searchBooksByTitle:async({title:d,onSuccess:o,onError:s})=>{const p=$fetch.create({baseURL:h,onResponse({response:a}){var t,e;i({message:"Books found by title",toastOps:{description:((t=a._data)==null?void 0:t.message)??""},type:"success"})(),o==null||o((e=a._data)==null?void 0:e.data)},onResponseError({response:a}){var t,e;i({message:"Failed to search books by title",toastOps:{description:((t=a._data)==null?void 0:t.message)??"Unknown error"},type:"error"})(),s==null||s(((e=a._data)==null?void 0:e.message)??"Search failed")}});return l.value=!0,p(`/api/v1/books/search/title?q=${encodeURIComponent(d)}`,{method:"GET"}).finally(()=>{l.value=!1})},suggestions:m,searchBooksByAuthor:async({author:d,onSuccess:o,onError:s})=>{const p=$fetch.create({baseURL:h,onResponse({response:a}){var t,e;i({message:"Books found by author",toastOps:{description:((t=a._data)==null?void 0:t.message)??""},type:"success"})(),o==null||o((e=a._data)==null?void 0:e.data)},onResponseError({response:a}){var t,e;i({message:"Failed to search books by author",toastOps:{description:((t=a._data)==null?void 0:t.message)??"Unknown error"},type:"error"})(),s==null||s(((e=a._data)==null?void 0:e.message)??"Search failed")}});return l.value=!0,p(`/api/v1/books/search/author?q=${encodeURIComponent(d)}`,{method:"GET"}).finally(()=>{l.value=!1})}}},{persist:{}});export{T as u};
