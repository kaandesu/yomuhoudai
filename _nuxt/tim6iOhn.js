import{a8 as u,q as h}from"./BwhD6OvJ.js";import{c as i}from"./OiylkajN.js";var g={};const y=g.DEV_MODE==="true",c=y?"http://127.0.0.1:1234":"https://laravel.yomuhoudai.club",T=u("Library",()=>{const n=h([]),k=h([]),l=h(!1);return{loading:l,books:n,getBooks:()=>$fetch.create({baseURL:c,onResponse({response:o}){var s;n.value=o._data.data??[],n.value.length>0&&i({message:"Books loaded successfully",toastOps:{description:((s=o._data.data)==null?void 0:s.message)??""},type:"success"})()},onResponseError({response:o}){var s;i({message:"Failed to load books",toastOps:{description:((s=o._data)==null?void 0:s.message)??"Unknown error"},type:"error"})()}})("/api/v1/books",{method:"GET"}),getBookById:({id:d,onSuccess:o,onError:s})=>{const r=$fetch.create({baseURL:c,onResponse({response:a}){var e,t;i({message:"Book loaded successfully",toastOps:{description:((e=a._data)==null?void 0:e.message)??""},type:"success"})(),o==null||o((t=a._data)==null?void 0:t.data)},onResponseError({response:a}){var e,t;i({message:`Failed to load book with id ${d}`,toastOps:{description:((e=a._data)==null?void 0:e.message)??"Unknown error"},type:"error"})(),s==null||s(((t=a._data)==null?void 0:t.message)??`Error loading book with id ${d}`)}});return l.value=!0,r(`/api/v1/books/${d}`,{method:"GET"}).finally(()=>{l.value=!1})},createBook:({book:d,onSuccess:o,onError:s})=>{const r=$fetch.create({baseURL:c,onResponse({response:a}){var t,p;if(!a.ok)return;i({message:"Book created successfully",toastOps:{description:((t=a._data)==null?void 0:t.message)??""},type:"success"})();const e=(p=a._data)==null?void 0:p.data;e&&(n.value.push(e),o==null||o(e))},onResponseError({response:a}){var e,t;i({message:"Failed to create book",toastOps:{description:((e=a._data)==null?void 0:e.message)??"Unknown error"},type:"error"})(),s==null||s(((t=a._data)==null?void 0:t.message)??"Failed to create book")}});return l.value=!0,r("/api/v1/books",{method:"POST",headers:{"Content-Type":"application/json"},body:d}).finally(()=>{l.value=!1})},updateBook:({id:d,book:o,onSuccess:s,onError:r})=>{const a=$fetch.create({baseURL:c,onResponse({response:e}){var t,p;i({message:"Book updated successfully",toastOps:{description:((t=e._data)==null?void 0:t.message)??""},type:"success"})(),s==null||s((p=e._data)==null?void 0:p.data)},onResponseError({response:e}){var t,p;i({message:`Failed to update book with id ${d}`,toastOps:{description:((t=e._data)==null?void 0:t.message)??"Unknown error"},type:"error"})(),r==null||r(((p=e._data)==null?void 0:p.message)??`Failed to update book with id ${d}`)}});return l.value=!0,a(`/api/v1/books/${d}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:o}).finally(()=>{l.value=!1})},deleteBook:({id:d,onSuccess:o,onError:s})=>{const r=$fetch.create({baseURL:c,onResponse({response:a}){var t;i({message:"Book deleted successfully",toastOps:{description:((t=a._data)==null?void 0:t.message)??""},type:"success"})();const e=n.value.findIndex(p=>p.id===d);e!==-1&&n.value.splice(e,1),o==null||o(a._data)},onResponseError({response:a}){var t,p,f;const e=((t=n.value.find(m=>m.id===d))==null?void 0:t.title)??`book with id ${d}`;i({message:`Failed to delete ${e}`,toastOps:{description:((p=a._data)==null?void 0:p.message)??"Unknown error"},type:"error"})(),s==null||s(((f=a._data)==null?void 0:f.message)??`Failed to delete book with id ${d}`)}});return l.value=!0,r(`/api/v1/books/${d}`,{method:"DELETE"}).finally(()=>{l.value=!1})},searchBooksByTitle:({title:d,onSuccess:o,onError:s})=>{const r=$fetch.create({baseURL:c,onResponse({response:a}){var e,t;i({message:"Books found by title",toastOps:{description:((e=a._data)==null?void 0:e.message)??""},type:"success"})(),o==null||o((t=a._data)==null?void 0:t.data)},onResponseError({response:a}){var e,t;i({message:"Failed to search books by title",toastOps:{description:((e=a._data)==null?void 0:e.message)??"Unknown error"},type:"error"})(),s==null||s(((t=a._data)==null?void 0:t.message)??"Search failed")}});return l.value=!0,r(`/api/v1/books/search/title?q=${encodeURIComponent(d)}`,{method:"GET"}).finally(()=>{l.value=!1})},suggestions:k,searchBooksByAuthor:({author:d,onSuccess:o,onError:s})=>{const r=$fetch.create({baseURL:c,onResponse({response:a}){var e,t;i({message:"Books found by author",toastOps:{description:((e=a._data)==null?void 0:e.message)??""},type:"success"})(),o==null||o((t=a._data)==null?void 0:t.data)},onResponseError({response:a}){var e,t;i({message:"Failed to search books by author",toastOps:{description:((e=a._data)==null?void 0:e.message)??"Unknown error"},type:"error"})(),s==null||s(((t=a._data)==null?void 0:t.message)??"Search failed")}});return l.value=!0,r(`/api/v1/books/search/author?q=${encodeURIComponent(d)}`,{method:"GET"}).finally(()=>{l.value=!1})}}},{persist:{}});export{T as u};
