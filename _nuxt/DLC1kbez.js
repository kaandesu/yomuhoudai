var J=Object.defineProperty;var Q=(t,e,i)=>e in t?J(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var $=(t,e,i)=>Q(t,typeof e!="symbol"?e+"":e,i);import{a1 as W,J as j,U as B,a2 as X,a3 as C,X as Y,a4 as x,a5 as E,i as Z,C as N,a6 as K,v as q,P as z,E as S,H as A,a7 as ee,j as ae,a8 as te,V,a9 as se,aa as ie,ab as oe}from"./CWs_moNM.js";import{c as D}from"./CeKZxgTK.js";const re=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],ne=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",k=[];class ce{constructor(){$(this,"_data",new F);$(this,"_hash",new F([...re]));$(this,"_nDataBytes",0);$(this,"_minBufferSize",0)}finalize(e){e&&this._append(e);const i=this._nDataBytes*8,a=this._data.sigBytes*8;return this._data.words[a>>>5]|=128<<24-a%32,this._data.words[(a+64>>>9<<4)+14]=Math.floor(i/4294967296),this._data.words[(a+64>>>9<<4)+15]=i,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(e,i){const a=this._hash.words;let s=a[0],l=a[1],n=a[2],v=a[3],y=a[4],u=a[5],o=a[6],d=a[7];for(let c=0;c<64;c++){if(c<16)k[c]=e[i+c]|0;else{const m=k[c-15],g=(m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3,O=k[c-2],w=(O<<15|O>>>17)^(O<<13|O>>>19)^O>>>10;k[c]=g+k[c-7]+w+k[c-16]}const h=y&u^~y&o,r=s&l^s&n^l&n,f=(s<<30|s>>>2)^(s<<19|s>>>13)^(s<<10|s>>>22),_=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),p=d+_+h+ne[c]+k[c],b=f+r;d=o,o=u,u=y,y=v+p|0,v=n,n=l,l=s,s=p+b|0}a[0]=a[0]+s|0,a[1]=a[1]+l|0,a[2]=a[2]+n|0,a[3]=a[3]+v|0,a[4]=a[4]+y|0,a[5]=a[5]+u|0,a[6]=a[6]+o|0,a[7]=a[7]+d|0}_append(e){typeof e=="string"&&(e=F.fromUtf8(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_process(e){let i,a=this._data.sigBytes/64;e?a=Math.ceil(a):a=Math.max((a|0)-this._minBufferSize,0);const s=a*16,l=Math.min(s*4,this._data.sigBytes);if(s){for(let n=0;n<s;n+=16)this._doProcessBlock(this._data.words,n);i=this._data.words.splice(0,s),this._data.sigBytes-=l}return new F(i,l)}}class F{constructor(e,i){$(this,"words");$(this,"sigBytes");e=this.words=e||[],this.sigBytes=i===void 0?e.length*4:i}static fromUtf8(e){const i=unescape(encodeURIComponent(e)),a=i.length,s=[];for(let l=0;l<a;l++)s[l>>>2]|=(i.charCodeAt(l)&255)<<24-l%4*8;return new F(s,a)}toBase64(){const e=[];for(let i=0;i<this.sigBytes;i+=3){const a=this.words[i>>>2]>>>24-i%4*8&255,s=this.words[i+1>>>2]>>>24-(i+1)%4*8&255,l=this.words[i+2>>>2]>>>24-(i+2)%4*8&255,n=a<<16|s<<8|l;for(let v=0;v<4&&i*8+v*6<this.sigBytes*8;v++)e.push(le.charAt(n>>>6*(3-v)&63))}return e.join("")}concat(e){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let i=0;i<e.sigBytes;i++){const a=e.words[i>>>2]>>>24-i%4*8&255;this.words[this.sigBytes+i>>>2]|=a<<24-(this.sigBytes+i)%4*8}else for(let i=0;i<e.sigBytes;i+=4)this.words[this.sigBytes+i>>>2]=e.words[i>>>2];this.sigBytes+=e.sigBytes}}function ue(t){return new ce().finalize(t).toBase64()}function T(t){return ue(W(t))}const de={trailing:!0};function fe(t,e=25,i={}){if(i={...de,...i},!Number.isFinite(e))throw new TypeError("Expected `wait` to be a finite number");let a,s,l=[],n,v;const y=(u,o)=>(n=he(t,u,o),n.finally(()=>{if(n=null,i.trailing&&v&&!s){const d=y(u,v);return v=null,d}}),n);return function(...u){return n?(i.trailing&&(v=u),n):new Promise(o=>{const d=!s&&i.leading;clearTimeout(s),s=setTimeout(()=>{s=null;const c=i.leading?a:y(this,u);for(const h of l)h(c);l=[]},e),d?(a=y(this,u),o(a)):l.push(o)})}}async function he(t,e,i){return await t.apply(e,i)}const ye=Symbol.for("nuxt:client-only"),ve=t=>t==="defer"||t===!1;function me(...t){var h;const e=typeof t[t.length-1]=="string"?t.pop():void 0;ge(t[0],t[1])&&t.unshift(e);let[i,a,s={}]=t;const l=j(()=>B(i));if(typeof l.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof a!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const n=X();s.server??(s.server=!0),s.default??(s.default=pe),s.getCachedData??(s.getCachedData=H),s.lazy??(s.lazy=!1),s.immediate??(s.immediate=!0),s.deep??(s.deep=C.deep),s.dedupe??(s.dedupe="cancel"),s._functionName,n._asyncData[l.value];const v={cause:"initial",dedupe:s.dedupe};(h=n._asyncData[l.value])!=null&&h._init||(v.cachedData=s.getCachedData(l.value,n,{cause:"initial"}),n._asyncData[l.value]=L(n,l.value,a,s,v.cachedData));const y=n._asyncData[l.value];y._deps++;const u=()=>n._asyncData[l.value].execute(v),o=s.server!==!1&&n.payload.serverRendered;{let r=function(m){const g=n._asyncData[m];g!=null&&g._deps&&(g._deps--,g._deps===0&&(g==null||g._off()))};const f=Y();if(f&&o&&s.immediate&&!f.sp&&(f.sp=[]),f&&!f._nuxtOnBeforeMountCbs){f._nuxtOnBeforeMountCbs=[];const m=f._nuxtOnBeforeMountCbs;x(()=>{m.forEach(g=>{g()}),m.splice(0,m.length)}),E(()=>m.splice(0,m.length))}const _=f&&(f._nuxtClientOnly||Z(ye,!1));o&&n.isHydrating&&(y.error.value||y.data.value!=null)?(y.pending.value=!1,y.status.value=y.error.value?"error":"success"):f&&(!_&&n.payload.serverRendered&&n.isHydrating||s.lazy)&&s.immediate?f._nuxtOnBeforeMountCbs.push(u):s.immediate&&u();const p=te(),b=N([l,...s.watch||[]],([m],[g])=>{var O,w;if((m||g)&&m!==g){const U=((O=n._asyncData[g])==null?void 0:O.data.value)!==C.value;g&&r(g);const R={cause:"initial",dedupe:s.dedupe};(w=n._asyncData[m])!=null&&w._init||(R.cachedData=s.getCachedData(m,n,{cause:"initial"}),n._asyncData[m]=L(n,m,a,s,R.cachedData)),n._asyncData[m]._deps++,(s.immediate||U)&&n._asyncData[m].execute(R)}else y._execute({cause:"watch",dedupe:s.dedupe})},{flush:"sync"});p&&K(()=>{b(),r(l.value)})}const d={data:M(()=>{var r;return(r=n._asyncData[l.value])==null?void 0:r.data}),pending:M(()=>{var r;return(r=n._asyncData[l.value])==null?void 0:r.pending}),status:M(()=>{var r;return(r=n._asyncData[l.value])==null?void 0:r.status}),error:M(()=>{var r;return(r=n._asyncData[l.value])==null?void 0:r.error}),refresh:(...r)=>n._asyncData[l.value].execute(...r),execute:(...r)=>n._asyncData[l.value].execute(...r),clear:()=>G(n,l.value)},c=Promise.resolve(n._asyncDataPromises[l.value]).then(()=>d);return Object.assign(c,d),c}function M(t){return j({get(){var e;return(e=t())==null?void 0:e.value},set(e){const i=t();i&&(i.value=e)}})}function ge(t,e){return!(typeof t=="string"||typeof t=="object"&&t!==null||typeof t=="function"&&typeof e=="function")}function G(t,e){e in t.payload.data&&(t.payload.data[e]=void 0),e in t.payload._errors&&(t.payload._errors[e]=C.errorValue),t._asyncData[e]&&(t._asyncData[e].data.value=void 0,t._asyncData[e].error.value=C.errorValue,t._asyncData[e].pending.value=!1,t._asyncData[e].status.value="idle"),e in t._asyncDataPromises&&(t._asyncDataPromises[e]&&(t._asyncDataPromises[e].cancelled=!0),t._asyncDataPromises[e]=void 0)}function _e(t,e){const i={};for(const a of e)i[a]=t[a];return i}function L(t,e,i,a,s){var d;(d=t.payload._errors)[e]??(d[e]=C.errorValue);const l=a.getCachedData!==H,n=i,v=a.deep?q:z,y=s!=null,u=t.hook("app:data:refresh",async c=>{(!c||c.includes(e))&&await o.execute({cause:"refresh:hook"})}),o={data:v(y?s:a.default()),pending:z(!y),error:S(t.payload._errors,e),status:z("idle"),execute:(c={})=>{if(t._asyncDataPromises[e]){if(ve(c.dedupe??a.dedupe))return t._asyncDataPromises[e];t._asyncDataPromises[e].cancelled=!0}if(c.cause==="initial"||t.isHydrating){const r="cachedData"in c?c.cachedData:a.getCachedData(e,t,{cause:c.cause??"refresh:manual"});if(r!=null)return t.payload.data[e]=o.data.value=r,o.error.value=C.errorValue,o.status.value="success",Promise.resolve(r)}o.pending.value=!0,o.status.value="pending";const h=new Promise((r,f)=>{try{r(n(t))}catch(_){f(_)}}).then(async r=>{if(h.cancelled)return t._asyncDataPromises[e];let f=r;a.transform&&(f=await a.transform(r)),a.pick&&(f=_e(f,a.pick)),t.payload.data[e]=f,o.data.value=f,o.error.value=C.errorValue,o.status.value="success"}).catch(r=>{if(h.cancelled)return t._asyncDataPromises[e];o.error.value=ee(r),o.data.value=ae(a.default()),o.status.value="error"}).finally(()=>{h.cancelled||(o.pending.value=!1,delete t._asyncDataPromises[e])});return t._asyncDataPromises[e]=h,t._asyncDataPromises[e]},_execute:fe((...c)=>o.execute(...c),0,{leading:!0}),_default:a.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{var c;u(),(c=t._asyncData[e])!=null&&c._init&&(t._asyncData[e]._init=!1),l||A(()=>{var h;(h=t._asyncData[e])!=null&&h._init||(G(t,e),o.execute=()=>Promise.resolve(),o.data.value=C.value)})}};return o}const pe=()=>C.value,H=(t,e,i)=>{if(e.isHydrating)return e.payload.data[t];if(i.cause!=="refresh:manual"&&i.cause!=="refresh:hook")return e.static.data[t]};function P(t,e,i){const[a={},s]=typeof e=="string"?[{},e]:[e,i],l=j(()=>B(t)),n=j(()=>B(a.key)||"$f"+T([s,typeof l.value=="string"?l.value:"",...De(a)]));if(!a.baseURL&&typeof l.value=="string"&&l.value[0]==="/"&&l.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:v,lazy:y,default:u,transform:o,pick:d,watch:c,immediate:h,getCachedData:r,deep:f,dedupe:_,...p}=a,b=V({...se,...p,cache:typeof a.cache=="boolean"?void 0:a.cache}),m={server:v,lazy:y,default:u,transform:o,pick:d,immediate:h,getCachedData:r,deep:f,dedupe:_,watch:c===!1?[]:[...c||[],b]};if(!h){let w=function(){m.immediate=!0};N(n,w,{flush:"sync",once:!0}),N([...c||[],b],w,{flush:"sync",once:!0})}let g;return me(c===!1?n.value:n,()=>{var I;(I=g==null?void 0:g.abort)==null||I.call(g,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),g=typeof AbortController<"u"?new AbortController:{};const w=B(a.timeout);let U;return w&&(U=setTimeout(()=>g.abort(new DOMException("Request aborted due to timeout.","AbortError")),w),g.signal.onabort=()=>clearTimeout(U)),(a.$fetch||globalThis.$fetch)(l.value,{signal:g.signal,...b}).finally(()=>{clearTimeout(U)})},m)}function De(t){var i;const e=[((i=B(t.method))==null?void 0:i.toUpperCase())||"GET",B(t.baseURL)];for(const a of[t.params||t.query]){const s=B(a);if(!s)continue;const l={};for(const[n,v]of Object.entries(s))l[B(n)]=B(v);e.push(l)}if(t.body){const a=B(t.body);if(!a)e.push(T(a));else if(a instanceof ArrayBuffer)e.push(T(Object.fromEntries([...new Uint8Array(a).entries()].map(([s,l])=>[s,l.toString()]))));else if(a instanceof FormData){const s={};for(const l of a.entries()){const[n,v]=l;s[n]=v instanceof File?v.name:v}e.push(T(s))}else if(ie(a))e.push(T(V(a)));else try{e.push(T(a))}catch{console.warn("[useFetch] Failed to hash body",a)}}return e}const Oe=oe("Library",()=>{const t=q([]),e=q(!1),i=async({onSuccess:u,onError:o}={})=>{var f,_,p,b,m;e.value=!0;const d="/api/v1/books",{data:c,error:h,status:r}=await P(`${d}`,{method:"GET"},"$zr4nyfsTx3");e.value=!1,r.value==="success"&&!h.value&&c.value!=null?(t.value=((f=c.value)==null?void 0:f.data)??[],D({message:"Books loaded successfully",toastOps:{description:((_=c.value)==null?void 0:_.message)??""},type:"success"})(),u==null||u((p=c.value)==null?void 0:p.data)):(D({message:"Failed to load books",toastOps:{description:((b=h.value)==null?void 0:b.statusMessage)??"Unknown error"},type:"error"})(),o==null||o(((m=h.value)==null?void 0:m.statusMessage)??"Failed to fetch books"))};return{loading:e,books:t,getBooks:i,getBookById:async({id:u,onSuccess:o,onError:d})=>{var _,p;e.value=!0;const c=`/api/v1/books/${u}`,{data:h,error:r,status:f}=await P(`${c}`,{method:"GET"},"$MIx4hiFoyp");e.value=!1,f.value==="success"&&!r.value?(D({message:"Book loaded successfully",toastOps:{description:((_=h.value)==null?void 0:_.message)??""},type:"success"})(),o==null||o((p=h.value)==null?void 0:p.data)):(D({message:`Failed to load book with id ${u}`,toastOps:{description:r.value??`Error fetching book with id ${u}`},type:"error"})(),d==null||d(r.value??`Failed to fetch book with id ${u}`))},createBook:async({book:u,onSuccess:o,onError:d})=>{var _,p;e.value=!0;const c="/api/v1/books",{data:h,error:r,status:f}=await P(`${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)},"$hnmTN7-7GC");e.value=!1,f.value==="success"&&!r.value?(D({message:"Book created successfully",toastOps:{description:((_=h.value)==null?void 0:_.message)??""},type:"success"})(),o==null||o((p=h.value)==null?void 0:p.data)):(D({message:"Failed to create book",toastOps:{description:r.value??"Unknown error"},type:"error"})(),d==null||d(r.value??"Failed to create book"))},updateBook:async({id:u,book:o,onSuccess:d,onError:c})=>{var p,b;e.value=!0;const h=`/api/v1/books/${u}`,{data:r,error:f,status:_}=await P(`${h}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)},"$jroS2fKQzC");e.value=!1,_.value==="success"&&!f.value?(D({message:"Book updated successfully",toastOps:{description:((p=r.value)==null?void 0:p.message)??""},type:"success"})(),d==null||d((b=r.value)==null?void 0:b.data)):(D({message:`Failed to update book with id ${u}`,toastOps:{description:f.value??`Error updating book with id ${u}`},type:"error"})(),c==null||c(f.value??`Failed to update book with id ${u}`))},deleteBook:async({id:u,onSuccess:o,onError:d})=>{var _;e.value=!0;const c=`/api/v1/books/${u}`,{data:h,error:r,status:f}=await P(`${c}`,{method:"DELETE"},"$RQuxihGNY5");e.value=!1,f.value==="success"&&!r.value?(D({message:"Book deleted successfully",toastOps:{description:""},type:"success"})(),await i(),o==null||o()):(D({message:`Failed to delete book with id ${u}`,toastOps:{description:h.value&&h.value.message?h.value.message:((_=r.value)==null?void 0:_.statusMessage)??`Error deleting book with id ${u}`},type:"error"})(),d==null||d(r.value??`Failed to delete book with id ${u}`))},searchBooksByTitle:async({title:u,onSuccess:o,onError:d})=>{var _,p;e.value=!0;const c="/api/v1/books/search/title",{data:h,error:r,status:f}=await P(`${c}?q=${encodeURIComponent(u)}`,{method:"GET"},"$2rJ_3AV5CC");e.value=!1,f.value==="success"&&!r.value?(D({message:"Books found by title",toastOps:{description:((_=h.value)==null?void 0:_.message)??""},type:"success"})(),o==null||o((p=h.value)==null?void 0:p.data)):(D({message:"Failed to search books by title",toastOps:{description:r.value??"Unknown error"},type:"error"})(),d==null||d(r.value??"Failed to search books by title"))},searchBooksByAuthor:async({author:u,onSuccess:o,onError:d})=>{var _,p;e.value=!0;const c="/api/v1/books/search/author",{data:h,error:r,status:f}=await P(`${c}?q=${encodeURIComponent(u)}`,{method:"GET"},"$qHWkJeXrhB");e.value=!1,f.value==="success"&&!r.value?(D({message:"Books found by author",toastOps:{description:((_=h.value)==null?void 0:_.message)??""},type:"success"})(),o==null||o((p=h.value)==null?void 0:p.data)):(D({message:"Failed to search books by author",toastOps:{description:r.value??"Unknown error"},type:"error"})(),d==null||d(r.value??"Failed to search books by author"))}}},{persist:{}});export{Oe as u};
